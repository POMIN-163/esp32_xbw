#include "fabgl.h"
#include "fabui.h"
#include "displaycontroller.h"
#include "freertos/FreeRTOS.h"

#define DEBUG 1
fabgl::SoundGenerator soundGenerator;

#include "sound.h"

const int8_t invadersSoundSamples_1[] = {
  -6,  -17,  -29,  -41,  -61,  -75,  -88, -103, -110, -114, -118, -112, -105,  -97,  -86,  -74,
 -62,  -42,  -29,  -20,   -5,    7,   19,   35,   48,   58,   66,   80,   91,   95,  103,  108,
 112,  116,  120,  124,  126,  125,  124,  124,  124,  122,  118,  118,  116,  111,  108,  102,
  95,   91,   85,   78,   74,   69,   64,   57,   52,   47,   39,   35,   27,   15,   12,    8,
   4,   -3,   -8,  -13,  -21,  -26,  -31,  -39,  -43,  -49,  -56,  -61,  -66,  -73,  -69,  -65,
 -63,  -63,  -57,  -50,  -46,  -39,  -34,  -34,  -37,  -38,  -34,  -42,  -50,  -57,  -65,  -73,
 -81,  -89,  -96, -106, -122, -126, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128,
-128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128,
-128, -128, -128, -127, -125, -117, -109, -101,  -98,  -90,  -79,  -70,  -63,  -56,  -52,  -42,
 -30,  -18,  -10,   -4,    0,    7,   14,   22,   34,   43,   51,   59,   67,   73,   78,   84,
  91,   95,  102,  108,  111,  122,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,
 127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,
 127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,
 127,  127,  127,  127,  127,  127,  127,  127,  127,  122,  116,  108,  107,  105,  101,   97,
  92,   84,   84,   79,   72,   68,   67,   65,   57,   52,   47,   40,   35,   31,   28,   24,
  22,   21,   14,    8,    4,    1,   -2,   -6,  -11,  -14,  -18,  -22,  -26,  -30,  -33,  -34,
 -38,  -46,  -46,  -48,  -51,  -51,  -56,  -63,  -63,  -65,  -72,  -83,  -99, -114, -128, -128,
-128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -127, -117,
-108, -100,  -88,  -76,  -65,  -53,  -48,  -42,  -30,  -25,  -19,  -12,  -12,   -7,    0,    0,
   0,    0,    0,    0,    0,    0,   -3,   -7,  -11,  -15,  -18,  -23,  -27,  -26,  -23,  -31,
 -36,  -40,  -44,  -48,  -53,  -61,  -65,  -71,  -79,  -83,  -87,  -91,  -95,  -99, -102, -106,
-110, -113, -118, -122, -125, -125, -126, -128, -128, -128, -126, -124, -120, -111, -100,  -93,
 -85,  -80,  -80,  -80,  -80,  -80,  -83,  -86,  -91,  -98, -106, -113, -117, -123, -128, -128,
-128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128,
-128, -128, -128, -128, -128, -128, -128, -128, -127, -125, -119, -111, -104,  -96,  -88,  -81,
 -73,  -65,  -57,  -46,  -34,  -22,  -15,   -7,    0,    8,   15,   24,   36,   44,   53,   65,
  74,   82,   89,  101,  110,  118,  124,  127,  127,  127,  127,  127,  127,  127,  127,  127,
 127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,
 127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,
 127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,
 127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  126,
 124,  119,  112,  112,  109,  105,   97,   89,   82,   79,   71,   67,   67,   59,   52,   44,
  40,   36,   32,   29,   25,   20,   12,    7,    5,    5,    1,    0,    0,   -8,  -13,  -17,
 -21,  -23,  -24,  -31,  -36,  -43,  -54,  -72,  -92, -111, -122, -128, -128, -128, -128, -128,
-128, -128, -128, -128, -128, -128, -128, -128, -125, -119, -107,  -98,  -90,  -78,  -67,  -55,
 -48,  -40,  -32,  -24,  -19,  -15,  -12,  -12,  -10,   -6,   -6,   -6,   -5,   -1,   -2,   -6,
  -6,   -8,  -12,  -12,  -14,  -17,  -17,  -24,  -32,  -40,  -44,  -47,  -51,  -55,  -59,  -64,
 -72,  -79,  -85,  -85,  -92, -100, -107, -111, -117, -125, -127, -128, -128, -128, -128, -128,
-128, -128, -128, -128, -128, -128, -128, -128, -126, -124, -120, -116, -112, -108, -110, -112,
-108, -114, -121, -127, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128,
-128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128,
-128, -128, -128, -128, -128, -128, -128, -128, -128, -127, -125, -119, -110, -103,  -92,  -82,
 -74,  -63,  -51,  -39,  -32,  -24,  -16,   -8,    0,    7,   19,   27,   35,   43,   55,   65,
  72,   80,   88,   96,  103,  111,  118,  125,  127,  127,  127,  127,  127,  127,  127,  127,
 127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,
 127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,
 127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,
 127,  127,  127,  127,  127,  127,  127,  127,  121,  116,  112,  108,  103,   95,   91,   87,
  83,   80,   76,   71,   63,   58,   54,   50,   47,   43,   39,   31,   28,   27,   23,   17,
   9,    2,    0,    0,    0,   -3,   -7,  -11,  -15,  -18,  -22,  -27,  -30,  -34,  -34,  -36,
 -42,  -58,  -74,  -90, -109, -121, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128,
-127, -125, -118, -109,  -98,  -86,  -75,  -63,  -51,  -41,  -33,  -26,  -18,  -10,   -2,    2,
   6,   10,   13,   17,   21,   22,   20,   16,   20,   19,   15,   12,   11,   10,    6,    2,
  -2,  -10,  -14,  -20,  -28,  -32,  -37,  -46,  -46,  -47,  -52,  -64,  -70,  -74,  -79,  -82,
 -86,  -90,  -97, -105, -112, -113, -115, -119, -123, -126, -128, -128, -128, -128, -128, -128,
-127, -125, -117, -109, -102,  -98,  -92,  -85,  -85,  -87,  -91,  -91,  -94,  -99, -106, -110,
-116, -124, -126, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128,
-128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128, -128,
-127, -125, -116, -107,  -96,  -88,  -82,  -77,  -66,  -56,  -47,  -36,  -27,  -18,   -6,   -2,
   5,   16,   24,   32,   40,   52,   61,   68,   77,   84,   92,   99,  107,  115,  123,  125,
 127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,
 127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,
 127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,
 127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  126,  124,
 121,  116,  109,  103,  100,   96,   92,   88,   84,   80,   77,   72,   68,   62,   55,   51,
  50,   49,   45,   36,   26,   22,   22,   18,   11,    3,    0,    0,    0,   -2,   -6,  -10,
 -14,  -19,  -27,  -31,  -35,  -39,  -40,  -41,  -45,  -49,  -53,  -57,  -57,  -59,  -63,  -67,
 -71,  -75,  -79,  -82,  -83,  -80,  -83,  -86,  -91,  -95,  -98, -101,  -98,  -99, -102, -102,
-102, -102, -102, -105, -108, -108, -111, -113, -113, -117, -116, -113, -117, -116, -114, -118,
-115, -114, -118, -115, -113, -113, -113, -115, -118, -114, -113, -113, -113, -110, -106, -102,
-105, -106, -102, -105, -106, -101,  -98,  -98, -101,  -98,  -97,  -97,  -97,  -97,  -95,  -91,
 -91,  -89,  -85,  -85,  -85,  -84,  -81,  -77,  -74,  -78,  -77,  -72,  -68,  -71,  -72,  -68,
 -68,  -66,  -63,  -58,  -59,  -62,  -58,  -54,  -51,  -55,  -53,  -50,  -46,  -46,  -44,  -40,
 -36,  -35,  -39,  -35,  -32,  -29,  -29,  -26,  -23,  -28,  -25,  -23,  -23,  -19,  -17,  -17,
 -13,  -12,  -11,   -7,   -3,    0,    0,    0,    0,    0,    0,    0,    0,    0,    1,    4,
   1,    1,    5,    9,   11,   10,    6,    8,   11,   11,   13,   17,   21,   18,   17,   22,
  26,   25,   22,   26,   25,   22,   27,   30,   31,   28,   30,   31,   28,   31,   33,   33,
  33,   33,   33,   37,   36,   34,   38,   42,   43,   39,   42,   45,   45,   45,   42,   39,
  43,   45,   45,   49,   47,   45,   49,   47,   46,   49,   46,   45,   45,   48,   48,   45,
  45,   47,   49,   45,   45,   46,   49,   47,   46,   49,   46,   45,   45,   48,   47,   45,
  48,   47,   43,   39,   39,   40,   44,   41,   40,   44,   40,   36,   33,   33,   35,   38,
  34,   36,   37,   33,   33,   33,   33,   36,   37,   32,   29,   29,   33,   33,   33,   32,
  28,   24,   23,   27,   28,   28,   28,   28,   25,   22,   26,   28,   28,   28,   25,   20,
  16,   16,   17,   21,   18,   17,   21,   17,   18,   21,   17,   13,   11,   15,   13,   11,
  15,   16,   14,   11,   14,   14,   10,    6,    7,   11,   11,   11,   10,    5,    8,    9,
   5,    5,    5,    5,    8,    8,    5,    5,    2,    0,    3,    2,    0,    0,    0,    0,
   0,    0,    0,    0,    0,    0,    0,    0,   -5,  -11,   -7,   -9,  -10,   -6,   -9,  -13,
 -16,  -13,  -12,  -12,  -15,  -17,  -16,  -13,  -14,  -16,  -12,  -14,  -15,  -12,  -14,  -17,
 -17,  -13,  -13,  -16,  -13,  -14,  -17,  -17,  -14,  -12,  -16,  -14,  -13,  -16,  -17,  -17,
 -17,
 };


void soundTest(void)
{
    fabgl::SamplesGenerator *music_ = nullptr;
    music_ = soundGenerator.playSamples(invadersSoundSamples_1, sizeof(invadersSoundSamples_1), 100, -1);
    vTaskDelay(1000*5);
}